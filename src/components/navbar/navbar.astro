---
import Container from "../container.astro";
import Link from "../ui/link.astro";
import { Astronav, MenuItems, MenuIcon } from "astro-navbar";

const products = [
  { title: "Forms", path: "/forms/", matches: ["/forms/", "/survey-maker/", "/quiz-builder/", "/form-builder/", "/custom-calculator-builder/"] },
  { title: "Shared Inbox", path: "/shared-inbox/", matches: ["/shared-inbox/", "/crm/"] },
];

const currentPath = Astro.url.pathname;
const isActive = (product: typeof products[0]) => product.matches.some(p => currentPath.startsWith(p));
---

<Container>
  <header class="flex flex-col lg:flex-row justify-between items-center my-5">
    <Astronav>
      <div class="flex w-full lg:w-auto items-center justify-between">
        <div class="flex items-center gap-8">
          <a href="/" class="flex items-center">
            <img src="/images/logo.svg" alt="Shout.com" class="h-12 w-auto">
          </a>
          <nav class="hidden lg:flex">
            <ul class="flex flex-row items-center gap-1">
              {
                products.map((product) => (
                  <li>
                    <a
                      href={product.path}
                      class:list={[
                        "px-4 py-2 rounded-full transition-colors",
                        isActive(product)
                          ? "bg-gray-100 text-gray-900 font-medium"
                          : "text-gray-600 hover:bg-gray-100 hover:text-gray-900"
                      ]}>
                      {product.title}
                    </a>
                  </li>
                ))
              }
            </ul>
          </nav>
        </div>
        <div class="flex lg:hidden items-center gap-3">
          <a href="/signup/" class="inline-flex items-center px-4 py-2 rounded-full text-sm font-medium bg-gray-900 text-white">
            Start Free Trial
          </a>
          <MenuIcon class="w-4 h-4 text-gray-800" />
        </div>
      </div>
      <MenuItems class="hidden w-full lg:w-auto mt-2 lg:hidden">
        <ul class="flex flex-col gap-1">
          {
            products.map((product) => (
              <li>
                <a
                  href={product.path}
                  class:list={[
                    "block px-4 py-2 text-sm transition-colors",
                    isActive(product)
                      ? "bg-gray-100 text-gray-900 font-medium"
                      : "text-gray-600 hover:bg-gray-100 hover:text-gray-900"
                  ]}>
                  {product.title}
                </a>
              </li>
            ))
          }
        </ul>
        <div class="flex flex-col items-center mt-3 gap-3">
          <Link href="/pricing/" style="muted" block size="md">Pricing</Link>
          <Link href="/login/" style="muted" block size="md">Log in</Link>
          <Link href="/signup/" size="md" block>Start Free Trial</Link>
        </div>
      </MenuItems>
    </Astronav>
    <div>
      <div class="hidden lg:flex items-center gap-4">
        <a href="/pricing/" class="text-gray-600 hover:text-gray-900">Pricing</a>
        <a href="/login/" class="text-gray-600 hover:text-gray-900">Log in</a>
        <Link href="/signup/" size="md">Start Free Trial</Link>
      </div>
    </div>
  </header>
</Container>
